---
description: SPEC Review - Verify SPEC completeness and code consistency
argument-hint: [review scope(all/REQ-XXX)]
---

# SPEC Review Command

## Core Responsibilities

**Thin entry point for SPEC review, detect project status and call /spec-review skill**

- âŒ **Don't implement** specific review logic
- âŒ **Don't do** code analysis
- âœ… **Only detect** project status
- âœ… **Only collect** review parameters
- âœ… **Only call** /spec-review skill

---

## Execution Flow

### Phase 0: Project Status Detection (Automatic)

```bash
echo "=== SPEC Review Starting ==="

# 1. Check SPEC/ directory
if [ ! -d "SPEC" ]; then
    echo "âŒ SPEC/ directory does not exist"
    echo "Please run /spec-init first to initialize SPEC"
    exit 1
fi

# 2. Check if spec command is available
if ! command -v spec &> /dev/null; then
    echo "âš ï¸  spec CLI not installed"
    echo "Trying built-in review logic..."
fi

# 3. Count SPEC files
req_count=$(grep -c "REQ-" SPEC/01-REQUIREMENTS.md 2>/dev/null || echo 0)
arch_count=$(grep -c "ARCH-" SPEC/02-ARCHITECTURE.md 2>/dev/null || echo 0)
data_count=$(grep -c "DATA-" SPEC/03-DATA-STRUCTURE.md 2>/dev/null || echo 0)
api_count=$(grep -c "API-" SPEC/04-API-DESIGN.md 2>/dev/null || echo 0)

echo "Detected:"
echo "- Requirements (REQ-XXX): $req_count"
echo "- Architecture (ARCH-XXX): $arch_count"
echo "- Data (DATA-XXX): $data_count"
echo "- Interfaces (API-XXX): $api_count"
```

---

### Phase 1: Collect Review Parameters

**If user provides parameters**:
```bash
# Example: /spec-audit REQ-AUTH-001
SCOPE="$1"  # REQ-AUTH-001
```

**If user doesn't provide parameters**:
```bash
# Default: full review
SCOPE="full"
```

---

### Phase 2: Call /spec-review Skill

**Parameters to pass to skill**:
```markdown
# SPEC Review Request

**Review Scope**: $SCOPE
**Project Path**: $(pwd)
**SPEC Statistics**:
- Requirements: $req_count
- Architecture: $arch_count
- Data: $data_count
- Interfaces: $api_count

**Review Dimensions**:
1. âœ… Format completeness
2. âœ… Requirement completeness (acceptance criteria)
3. âœ… Architecture consistency
4. âœ… Data model consistency
5. âœ… API interface consistency
6. âœ… CLAUDE.md compliance
7. âœ… Product-level contract file review
8. âœ… Test case quality review

Please execute complete review and generate report.
```

---

### Phase 3: Present Review Results

**Receive output from /spec-review skill**:
```markdown
âœ… SPEC Review Complete!

**Review Results**:
- Format completeness: âœ… 100%
- Requirement completeness: âš ï¸ 85%
- Architecture consistency: âœ… 90%
- Data consistency: âš ï¸ 75%
- API consistency: âœ… 95%
- CLAUDE.md compliance: âœ… 100%
- Contract file consistency: âš ï¸ 80%
- Test case coverage: âš ï¸ 60%

**Overall Score: 85%**

**Detailed Report**: Generated /tmp/claude-reports/SPEC-REVIEW-REPORT.md

**Next Steps**:
1. ğŸ”§ Fix issues: Use /architect to correct SPEC
2. ğŸ’» Complete implementation: Use /programmer to add code
3. ğŸ§‹ Review again: Use /spec-audit again
```

---

## Completion Message

```markdown
âœ… SPEC Review Complete!

**Review Dimensions**:
- âœ… Format completeness
- âœ… Requirement completeness
- âœ… Architecture consistency
- âœ… Data consistency
- âœ… API consistency
- âœ… CLAUDE.md compliance
- âœ… Product-level contract file review
- âœ… Test case quality review

**Next Steps**:
1. ğŸ“ View detailed report
2. ğŸ”§ Use /architect to correct SPEC
3. ğŸ’» Use /programmer to add code
```

---

## Collaboration with Skills

```
/spec-audit (command)
    â†“ (detect project status)
    â†“ (collect review parameters)
    â†“
/spec-review (skill)
    â†“ (execute core review logic)
    â†“ (generate detailed report)
    â†“
Return to /spec-audit (present results)
```

---

## Prohibited Actions

- âŒ **Prohibit implementing specific review logic** - Leave to /spec-review skill
- âŒ **Prohibit duplicate code** - All review logic in skill
- âŒ **Prohibit generating reports** - Reports generated by skill
- âœ… **Only thin entry** - Detect status + call skill + present results

---

## Core Principles

**spec-audit = Thin Entry Layer**

- Detect project status
- Collect review parameters
- Call /spec-review skill
- Present review results

All specific review logic is implemented in /spec-review skill.
